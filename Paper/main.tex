%% Short data paper template
%% Created by Simon Hengchen and Nilo Pedrazzini for the Journal of Open Humanities Data (https://openhumanitiesdata.metajnl.com)

\documentclass{article}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{johd}
\usepackage{braket}
\usepackage{multicol}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\D}{\mathbb{D}}
\newcommand{\DC}{\mathbb{DC}}
\newcommand{\GD}{\mathbb{GD}}
\newcommand{\GDC}{\mathbb{GDC}}
\newcommand{\Z}{\mathcal{O}_\e}
\newcommand{\e}{\epsilon}

\newcommand{\E}{\mathcal{E}}
\newcommand{\til}{\widetilde}
\renewcommand{\bar}{\overline}

\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}
\newcommand{\Sig}{\operatorname{Sig}}
\newcommand{\Inf}{\operatorname{Inf}}

\title{Postulates of quantum mechanics with dual-complex numbers}

\author{Nathan Houyet$^{a}$, Dogukan Bakircioglu$^{b}$, Pablo Arrighi$^{b}$ \\
        \small $^{a}$UniversitÃ© Paris-Saclay (student), France \\
        \small $^{b}$QuaCS, LMF, France \\
}
\date{}

\begin{document}
\maketitle

\section{Introduction}
\subsection{Complex and dual numbers}
\noindent Extending real numbers with an imaginary unit $i$ with $i^2 = -1$ gives rise to the complex numbers. They both are fields and complex linear algebra is used in quantum mechanics to represent physical systems and their evolution. The set of complex numbers is $\C = \{a + bi \; | \; a, b \in \R \text{ and } i^2 = 0\}$. If a number $z \in \C$ has the form $z = a + bi$ we denote $a$ the real part and $b$ the imaginary part. We can define the functions $\Re$ and $\Im$ as follows
\begin{multicols}{3}
\noindent
\begin{equation}
\Re: \C \to \R: a + bi \to a
\end{equation}

\columnbreak
\noindent
\begin{equation}
\Im: \C \to \R: a + bi \to b
\end{equation}

\columnbreak
\noindent
\begin{equation}
\forall z \in \C, z = \Re(z) + \Im(z)i
\end{equation}

\end{multicols}

Similarly, dual numbers $\D$ are generated by adding an imaginary unit $\e$ with $\e^2 = 0$ to the reals. To avoid confusion with complex, we call the real part of a dual the significant part ($\Sig$) and its imaginary part the infinitesimal part ($\Inf$).

\begin{multicols}{3}
\noindent
\begin{equation}
\Sig: \C \to \R: a + b\e \to a
\end{equation}

\columnbreak
\noindent
\begin{equation}
\Inf: \C \to \R: a + b\e \to b
\end{equation}
blabla
\columnbreak
\noindent
\begin{equation}
\forall d \in \D, d = \Sig(d) + \Inf(d)\e
\end{equation}

\end{multicols}

Extending the real numbers with both $i$ and $\e$ gives rise to dual-complex numbers $\DC$. We can also imagine the complex (resp. dual) number as the ring of polynomials with real coefficients over the variable $i$ ($\e$) modulo $i^2 + 1$ ($\e^2$). From an abstract algebra point of view we have:

\begin{multicols}{3}

\noindent
\begin{equation}
\C \approx \R [i]/\langle i^2+1 \rangle
\end{equation}

\columnbreak

\noindent
\begin{equation}
\D \approx \R [\e]/\langle \e^2 \rangle
\end{equation}

\columnbreak

\noindent
\begin{equation}
\DC \approx \C [\e]/\langle \e^2 \rangle
\end{equation}
\end{multicols}

In general, an extension of the reals with a single imaginary unit $X$ where $X^2 = bX + c$ is a hypercomplex number system of dimension two. Up to isomorphism, there are only three such number systems: the complex ($b^2 - 4c > 0$), the dual ($b^2 - 4c = 0$) and the perplex numbers ($b^2 + 4c < 0$). Only the complex numbers form a field. This means that $\D^n$ and $\DC^n$ for $n \in \N$ is a module rather than a vector space.

\subsection{Ring operations and inversion on dual-complex numbers}

This definition through polynomials gives immediately the following operations:

\begin{equation}
(z_1 + t_1 \e) + (z_2 + t_2 \e) = (z_1 + z_2) + (t_1 + t_2) \e
\end{equation}

\noindent \begin{equation}
(z_1 + t_1 \e) (z_2 + t_2 \e) = (z_1 z_2) + (t_1 z_2 + z_1 t_2) \e
\end{equation}

Notice how with the infinitesimal unit $z_2 t_2 \e^2$ vanish into oblivion when with the imaginary unit it becomes real and negative.

Before talking about division, we can single out the set $\Z = \{0 + t \e | t \in \C\} = i\e \R$ of purely imaginary-dual numbers. In fact, division is a bit problematic. We can observe three cases when dividing $w_1 = z_1 + t_1 \e$ by $w_2 = z_2 + t_2 \e$:

\begin{enumerate}
        \item $z_2 \neq 0$. In this case division is well defined and given by
        \begin{equation}
        \frac{z_1 + t_1 \e}{z_2 + t_2 \e} = \frac{(z_1 + t_1 \e)(z_2 - t_2 \e)}{(z_2 + t_2 \e)(z_2 - t_2 \e)} = \frac{z_1 z_2 - z_1 t_2 \e + t_1 z_2 \e}{z_2^2} = \frac{z_1}{z_2} + \frac{z_2 t_1 - z_1 t_2 }{z_2^2} \e
        \end{equation}
        \item $z_2 = 0$ and we divide the infinitesimal part ($z_1 = 0$). The usual constraint that $w' = \frac{w_1}{w2} \iff w'w_2 = w1$ leaves us (infinitely) many solutions. Let's say that we want to find $w' = z' + t'$, the quotient of $w1$ and $w2$.
        \begin{equation}
        z' + t' \e = \frac{t_1 \e}{t_2 \e} \iff z' t_2 \e + t' t_2 \e^2 = t_1 \e \iff z' = t_1/t_2
        \end{equation}
        There is no constraint on $t'$. However, a natural definition would be $t' = 0$, implying $\frac{t'_1 \e}{t'_2 \e} = \frac{t'_1}{t'_2}$.
        \item $z_2 = 0$ and we divide the (non-zero) non-dual part $z_1$. In this case we have no solution because $z' + t'\e = \frac{z_1}{t_2 \e} \iff z' t_2 \e = z_1$ which is impossible (by hypothesis $z', t_2, z_1 \in \C$).
\end{enumerate}

Division between $w_1$ and $w_2$ is therefore defined for $w_1 \in \Z$ or $w_2 \in \DC \setminus \Z$.

\section{Computational point of view}
\subsection{Exponentiation and rooting}

\begin{proposition}
$(z + t\e)^n = z^n + n z^{n-1} t \e$
\end{proposition}
\begin{proof}
$\DC$ is a commutative ring and therefore the binomial theorem holds.

\noindent \begin{equation}
(z + t\e)^n = \sum_{k=0}^n \binom{N}{k} z^{n-k}(t\e)^k = z^n + nz^{n-1}t\e + (t\e)^2 \sum_{k=2}^n \binom{N}{k} z^{n-k}(t\e)^{k-2} = z^n + nz^{n-1}t\e
\end{equation}
\end{proof}

\begin{corollary}
$\sqrt[n]{z + t \e} = \sqrt[n]{z} + (\frac{t}{n(\sqrt[n]{z})^{n-1}}) \e$
\end{corollary}

\subsection{Alternative definition}
From a computational point of view, a more useful definition of $\DC$ can be obtained from matrices. Let's define

\begin{multicols}{2}
\noindent
\begin{equation}
\E = \begin{pmatrix}
0 & 1\\
0 & 0
\end{pmatrix}
\end{equation}

\columnbreak

\noindent
\begin{equation}
\hat{z} = zI = \begin{pmatrix}
z & 0\\
0 & z
\end{pmatrix}
\end{equation}
\end{multicols}

For $z \in \C$. Then we have a ring isomorphism

\begin{equation}
\DC \approx \{\hat{z} + \hat{t} \E \; | \; z, t \in \C\}
\end{equation}

by simply overloading complex addition and multiplications (which can themselves be obtained through a similar definition of $i$ as a matrix) with matrix addition and multiplication. Note that these matrices commute and behave as we would expect, except for inversion. The matrices of the form $t\E$ ($\Z$) are not invertible so we can only divide when the dividor has a non-zero significant part.

\subsection{Automatic differentiation}

Dual numbers are useful for automatic differentiation. Given an analytic complex-to-complex function $f(z) = \sum_{n=0}^\infty \frac{f^{(n)}(0) z^n}{n!}$, we extend it by defining $\hat{f}$ as:

\begin{equation}
        \hat{f}: \DC \to \DC: w \e \to \sum_{n=0}^\infty \frac{f^{(n)}(0) w^n}{n!}
\end{equation}

The usefulness of dual numbers for differentiation comes from the following result:

\begin{theorem}[Automatic differentiation theorem]
        Given $f(w) = \sum_{n=0}^\infty \frac{f^{(n)}(0) w^n}{n!}$ we have
\begin{equation}
        \hat{f}(z + t\e) = f(z) + z f'(z) \e
\end{equation}
\end{theorem}
\begin{proof}
By proposition 1,
\begin{equation}
\begin{split}
        \hat{f}(z + t \e) &= \sum_{n=0}^\infty \frac{f^{(n)}(0) (z + t\e)^n}{n!} \\
                          &= \sum_{n=0}^\infty \frac{f^{(n)}(0) (z^n + nz^{n-1}t\e)}{n!} \\
\end{split}
\end{equation}

Then we get

\begin{equation}
\begin{split}
        \hat{f}(z + t \e) &= \sum_{n=0}^\infty \frac{f^{(n)}(0) z^n}{n!} + \sum_{n=0}^\infty \frac{f^{(n)}(0) nz^{n-1}t\e}{n!} \\
                          &= f(z) + t \e (\sum_{n=0}^\infty \frac{f^{(n)}(0) z^n}{n!})' \\
                          &= f(z) + t \e f'(z). \\
\end{split}
\end{equation}

\end{proof}

\begin{corollary}
$f'(z) = (\hat{f}(z+\e) - \hat{f}(z))/\e$
\end{corollary}

\section{Properties of $\D$ and $\DC$}

\subsection{Ring, quasi-field and ordering}

$\DC$ forms a commutative ring with characteristic zero. We also have $\DC/\Z \approx \C$ and $\D/\e\R \approx \R$ which means that $\Z$ and $\e\R$ are maximally ideal.

\subsection{Ordering dual and dual-complex numbers}

We know that while $\R$ can be ordered consistently with the field operations, this is not the case for $\C$. Indeed if $\C$ could be totally ordered we would have either $i > 0$ or $-i > 0$ and then $(\pm i)^2 = -1 > 0$.

\begin{proposition}
 $\D$ can be totally ordered w.r. to $\R$'s natural ordering and this order is unique up to $\pm \e > 0$.
\end{proposition}
\begin{proof}
 Since $\R[\e] \approx \R[-\e]$, we can choose wlog that $\e > 0$. Then we get immediately that for any $r \in \R^+$, $\e < r$, since otherwise we would have $\e^2 = 0 > r > 0$. This allows only one ordering that is compatible with $+$ and $\times$.

\begin{equation}
a_1 + b_1 \e \leq a_2 + b_2 \e \iff a_1 < a_2 \lor (a_1 = a_2 \land b_1 \leq b_2)
\end{equation}
\end{proof}

\subsection{Conjugation}

\noindent Conjugation for hypercomplex numbers of dimension 2 and imaginary unit $X$ is given by $\bar{a + bX} = a - bX$. In the case of duals, this conjugation induces a pseudo-module $|z + t\e| = z$ which is generate, in the sense that $|w| = 0$ is not equivalent to $|w| = 0$.

\cite{messelmi2015} suggests four different possible conjugations of interest for us

\begin{multicols}{4}
\noindent \begin{equation}
\bar{w} = \bar{z} + \bar{t}\e
\end{equation}

\columnbreak

\noindent \begin{equation}
\til{w} = z - t\e
\end{equation}

\columnbreak

\noindent \begin{equation}
\bar{\til{w}} = \bar{z} - \bar{t}\e
\end{equation}

\columnbreak

\noindent \begin{equation}
w^* = \bar{z}(1-t\e/z)
\end{equation}
\end{multicols}

$w^*$ is the only possible conjugation that satisfies both $w^*w \in \R$ and $\Re(\Sig(w)) = \Re(\Sig(w^*))$. It is, however, non-linear. Our purpose being to extend quantum mechanics with a unit for infinitesimal variations, this conjugation is unfortunate. For example, if we define $A^\dagger$ as being the linear operator such that $\braket{\psi|A|\phi} = (A \ket{psi})^* \cdot \ket{\phi}$ (where $\cdot$ is used to represent dot product), we have that in general $A^\dagger \neq (A^T)^*$.

On the other hand, $\bar{w}$, $\til{w}$ and $\bar{\til w}$ don't give rise to a module. We need our conjugation to be compatible with Hilbert spaces already in use and it seems reasonable for the norm to be dual since infinitesimal variations could lead to infinitesimal changes in the norm. This motivates our choice for $\bar{w}$.

\begin{definition}
For $n \in \N$, $\DC^n$ represents the module of vectors of length $n$ over $\DC$ equipped with an inner-product:
\begin{equation}
 \braket{\psi|\phi} = \sum_k \bar{\psi_k}\phi_k
\end{equation}

\end{definition}

We can observe the following properties given $w = z + t\e$

\begin{multicols}{3}
\noindent \begin{equation}
\bar{w_1 + w_2} = \bar{w_1} + \bar{w_2}
\end{equation}

\noindent \begin{equation}
w + \bar{w} = 2 \Re(z) + 2 \Re(t) \e
\end{equation}

\noindent \begin{equation}
|w| = 0 \iff z = 0
\end{equation}

\columnbreak

\noindent \begin{equation}
\bar{w_1  w_2} = \bar{w_1} ~ \bar{w_2}
\end{equation}

\noindent \begin{equation}
\bar{w}w = |z|^2 + 2 Re(z\bar{t}) \in \D
\end{equation}

\noindent \begin{equation}
|w| \geq 0
\end{equation}

\columnbreak

\noindent \begin{equation}
\bar{\bar{w}} = w
\end{equation}

\noindent \begin{equation}
|w| = \sqrt{\bar{w}w} = |z| + \frac{Re(z\bar{t})}{|z|}
\end{equation}

\end{multicols}

In particular equation (33) entails the following property.

\begin{lemma}
 For any $\ket{\psi} \in \DC^n$, $||\ket\psi|| = \sum_{k=1}^n \psi_k* \psi_k \geq 0$.
\end{lemma}
\begin{proof}[]
\end{proof}

We define the adjoint as the transpose conjugate, i.e. $A^\dagger = (A^T)^*$.

\section{Extending postulates}

\subsection{State space}

In traditional quantum mechanics, a physical system at a given time is entirely described by a complex unit vector, called a state vector. We want to extend states with $\e$ to represent infinitesimal variations in our system. We suggest the following modification of the first postulate:

\paragraph{Postulate 1.} An $\e$-state vector is a unit dual-complex vector.
\\

\noindent Is this potulate ``physical''? If we extend our physical complex system with $\e$, is the norm $1$? We can first notice

\begin{equation}
 \begin{split}
  || \ket{\psi(t + y \e)} || = 1 &\iff \braket{\psi(t + y \e) | \psi(t + y \e)} = 1 \\
                                 &\iff \braket{\psi(t) | \psi(t)} + y \e \braket{\psi'(t) | \psi(t)} + y \e \braket{\psi(t) | \psi'(t)} + y^2 \e^2 \braket{\psi'(t) | \psi'(t)} = 1 \\
                                 &\iff \braket{\psi(t) | \psi(t)} + 2 y \e Re(\braket{\psi'(t) | \psi(t)}) = 1\\
                                 &\iff \begin{cases}
      \text{(i) } \braket{\psi(t) | \psi(t)} \\
      \text{(ii) } \braket{\psi'(t) | \psi(t)} \in i\R
   \end{cases}
 \end{split}
\end{equation}

Condition (i) is always met since $\ket{\psi(t)}$ is a state. In the case of a derivation over time, condition (ii) will be met as a direct consequence of SchrÃ¶dinger's equation. We deal with the case of a partial derivation with respect to a (space) variable when the wave function is sufficiently well-behaved. Say $\Psi(x, t)$ is a wavefunction. Suppose the boundary conditions give us

\begin{equation}
 \lim_{x \to -\infty} \Psi(x, t) = \lim_{x \to +\infty} \Psi(x, t) = 0
\end{equation}

This assumption is very ``physical'', but is not implied by $\Psi$ being squared-integrable. Then, using integration by parts,

\begin{equation}
\begin{split}
 \braket{\Psi(t) | \frac{\partial}{\partial x} | \Psi(t)} &= \int_{-\infty}^\infty \Psi(x, t)^* \frac{\partial \Psi(x, t)}{\partial x} \mathrm{d}x\\
 &= \left. \braket{\Psi(x, t)|\Psi(x, t)} \right|_{-\infty}^\infty - \int_{-\infty}^\infty (\frac{\partial \Psi(x, t)}{\partial x})^* \Psi(x, t) \mathrm{d}x\\
 &= - (\braket{\Psi(t) | \frac{\partial}{\partial x} | \Psi(t)})^*
\end{split}
\end{equation}

Therefore the derivative operator is skew-hermitian and we always have $\braket{\psi'(t) | \psi(t)} \in i\R$. Our postulate can be seen as ``physical''.

\subsection{Evolution}

The evolution of the system must respect the previous definition of an $\e$-state, i.e. preserve a state norm. This is the same condition as for traditional quantum mechanics. We can easily see that a matrix $U_\e$ is such that $U_\e \ket{\psi}$ if and only if $U_\e^\dagger U_\e = I$.

For an operator acting on $\DC^n$ to preserve $\e$-states norm it must be of the form $U_\e = U - i \e U W$ where $U$ is a unitary and $W$ is hermitian. This can be seen from the fact that given $U_\e = A + B\e$, we have

\begin{equation}
 \begin{split}
  U_\e^\dagger U_\e = I &\iff A^\dagger A + \e A^\dagger B + \e B^\dagger A = I\\
                        &\iff \begin{cases}
      \text{(i) } A^\dagger A = I \\
      \text{(ii) } A^\dagger B + B^\dagger A = 0
   \end{cases}\\
                        &\iff \begin{cases}
      \text{(i) } U := A \text{ is a unitary.} \\
      \text{(ii) } U^\dagger B = - (U^\dagger B)^\dagger
   \end{cases}\\
 \end{split}
\end{equation}
\begin{equation}
 \begin{split}
      &U^\dagger B = - (U^\dagger B)^\dagger\\
      \iff &W := i U^\dagger B  \text{ is Hermitian.}\\
      \iff &B = -iUW \text{ and } W \text{ is Hermitian.}
 \end{split}
\end{equation}


\paragraph{Postulate 2.} An operator $U_\e$ represents a valid $\e$-evolution of a system if and only if $U_\e = U - i \e U W$ for some complex unitary $U$ and complex hermitian $W$.

\subsection{Measurement}

Given a dual-complex measurement operators collection $\{M_m\}$, which constraints should we enforce? First, we need probabilities given by $M_m^\dagger M_m$ to be greater than or equal to zero. Then the probability must sum to one. Finally, we should check that the result of the measurement is indeed a state.

For non-negative probabilities, we can see that $M_m^\dagger M_m$ is still a semipositive operator, as stated in lemma 7.

For the probability summing to one, the completness relation is the same as usual. For the dual-complex case, given a collection $\{M_m + \e N_m \}$ it can be rephrased as

\begin{multicols}{2}
\noindent \begin{equation}
 \text{(i) } \sum_m M_m^\dagger M_m = I
\end{equation}
\columnbreak
\noindent \begin{equation}
 \text{(ii) } i \sum_m M_m^\dagger N_m \text{ is Hermitian.}
\end{equation}
\end{multicols}

\noindent by following a reasoning close to that of equations 39 and 40.

Is $M_m \ket\psi/\sqrt{p_m}$ an $\e$-state? Yes, since $||M_m \ket\psi/\sqrt{p_m}|| = \sqrt{\frac{1}{p_m}\bra\psi M_m^\dagger M_m \ket\psi} = 1$.

\paragraph{Postulate 3.} A set of operators $\{M_m\}$ is a measurement operator collection if it is bound by the complentess relation. The outcome $m$ appears with probability $p(m) = \bra\psi M_m^\dagger M_m \ket\psi$. The resulting state is

\begin{equation}
 \ket{\psi'} = \frac{M_m \ket\psi}{p(m)}
\end{equation}


\subsection{Composite systems}

Extending our system to composite systems is the easiest step. The tensor product of two $\e$-states is always an $\e$-state, allowing the following postulate

\paragraph{Postulate 4.} Given two $\e$-states representing two systems, the composite system is represented by the tensor product of these two $\e$-states.

\section{Alternative postulates}

\subsection{Pathological wave function}

It is possible to build pathological normalizable, analytical and continuous wave functions such that $r := \left. \braket{\Psi(x)|\Psi(x)} \right|_{-\infty}^\infty \neq 0$. In this case, we get $||\Psi(x + y \e)|| = 1 + y r \e$.

\paragraph{Postulate 1'.} A pathological $\e$-state is a vector $\ket\psi$ in $\DC^n$ such that $||\ket\psi|| = 1 \mod \Z$.

To preserve pathological $\e$-stateness, a valid operator $U_\e = U + \e V$ need only to satisfy $U$ unitary, as $U_\e = U \mod \Z$.

\paragraph{Postulate 2'.} An $\e$-evolution of a pathological system is given by $U_\e = U + \e V$ where $U$ is unitary and $V$ is any linear operator.

For measurement, probabilities should once again sum to one. But it would mean $U_\e^\dagger U_\e = I$, which sends us back to the well-behaved case. An extension modulo $\Z$ would be

\paragraph{Postulate 3'.} A measurement is defined by a collection $\{M_m\}$ of measurement operators with $\sum_m M_m^\dagger M_m = I \mod \Z$.

With the consequence of probabilities summing to $1 + \Z$, leading to negative infinitesimal probabilities (if $P(A) = 1 + \e$, $P(\bar{A}) = 1 - 1 - \e = -\e$).

For postulate 4, we satisfy ourselves with noting that $||\ket\psi|| = ||\ket\phi|| = 1 \mod O_\e$ implies $||\ket\psi \otimes \ket\phi|| = 1 \mod O_\e$.

\subsection{Other constraints}

\bibliographystyle{johd}
\bibliography{bib}

\end{document}
